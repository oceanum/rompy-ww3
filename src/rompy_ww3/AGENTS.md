# CORE PACKAGE KNOWLEDGE BASE

**Generated:** 2026-02-10
**Commit:** e5cdaa5
**Branch:** main

## OVERVIEW
Core rompy-ww3 package with main configuration, CLI, grid handling, and data management for WW3 modeling.

## STRUCTURE

```
src/rompy_ww3/
├── __init__.py          # Package exports (NMLConfig, Config, version)
├── config.py            # Main NMLConfig class with component management
├── cli.py               # Typer-based CLI commands
├── grid.py              # Grid classes (RectGrid, CurvGrid, UnstGrid, SmcGrid)
├── data.py              # WW3DataBlob, data assimilation
├── source.py            # Ww3Source for data source handling
├── namelist_composer.py # Namelist composition orchestration
├── settings.py          # Package settings
└── [subdirs]            # namelists/, components/, core/
```

## WHERE TO LOOK

| Task | Location | Notes |
|------|----------|-------|
| Main config | `config.py` | NMLConfig class, component orchestration |
| CLI commands | `cli.py` | init, run, create_grid, validate_config |
| Grid types | `grid.py` | Union type AnyWw3Grid for all grids |
| Data handling | `data.py` | WW3DataBlob with assimilation support |
| Source config | `source.py` | Variable mapping, template context |
| Composer | `namelist_composer.py` | Cross-namelist validation |

## CONVENTIONS

**Package-specific patterns:**

- **Version**: Single source in `__init__.py`, managed by tbump
- **Entry Point**: Plugin registers `rompy.config.ww3nml` → `NMLConfig`
- **Grid Union**: `AnyWw3Grid = RectGrid | CurvGrid | UnstGrid | SmcGrid`
- **Config Alias**: `Config = NMLConfig` for backward compatibility
- **CLI Script**: `rompy_ww3` command defined in pyproject.toml

## ANTI-PATTERNS

**Core package prohibitions:**

- **No circular imports**: Delay imports in `__init__.py` to avoid cycles
- **No hardcoded paths**: Use runtime objects for paths
- **Grid consistency**: Always validate grid closure (360° → 'SMPL')
- **Date handling**: Use Period objects, not raw strings internally

## NOTES

- **Plugin Integration**: Entry points declared in pyproject.toml
- **Version**: 0.1.0 (managed via tbump.toml)
- **Dependencies**: rompy, typer, rich

---

## DEVELOPMENT GUIDELINES

### Commit Practices
**DO NOT add AI tool attributions to commits** (e.g., "Generated by...", "Co-authored-by: AI...", "Ultraworked with..."). Keep commit messages clean and focused on the actual changes.
