$WW3 - Model configuration template used by rompy
$Template: {{_template}}
$Generated: {{runtime._generated_at}} on {{runtime._generated_on}} by {{runtime._generated_by}}
$

$ Model configuration generated from rompy-ww3
$ Namelist files will be written to: {{namelists_dir}}

$ Available namelists:
{%- for name, content in namelists.items() %}
$ - {{name}}
{%- endfor %}

$ Execution script:
#!/bin/bash
# WW3 run script generated by rompy-ww3

set -e

# Set up environment
export WW3_DIR={{config.model_dir|default('/path/to/ww3')}}
export PATH=$WW3_DIR/bin:$PATH

# Create work directory
mkdir -p {{staging_dir}}

# Copy namelist files
cp {{namelists_dir}}/* {{staging_dir}}/

# Run WW3 grid preprocessor if needed
if [ -f "{{staging_dir}}/grid.nml" ]; then
    echo "Running WW3 grid preprocessor..."
    cd {{staging_dir}}
    $WW3_DIR/bin/ww3_grid || exit 1
fi

# Run WW3 boundary preprocessor if needed
if [ -f "{{staging_dir}}/bound.nml" ]; then
    echo "Running WW3 boundary preprocessor..."
    cd {{staging_dir}}
    $WW3_DIR/bin/ww3_bound || exit 1
fi

# Run WW3 forcing preprocessor if needed
if [ -f "{{staging_dir}}/forcing.nml" ]; then
    echo "Running WW3 forcing preprocessor..."
    cd {{staging_dir}} 
    $WW3_DIR/bin/ww3_prep || exit 1
fi

# Run WW3 model
echo "Running WW3 model..."
cd {{staging_dir}}
$WW3_DIR/bin/ww3_shel || exit 1

# Run WW3 post processors if needed
if [ -f "{{staging_dir}}/field.nml" ]; then
    echo "Running WW3 field post-processor..."
    cd {{staging_dir}}
    $WW3_DIR/bin/ww3_ounf || exit 1
fi

if [ -f "{{staging_dir}}/point.nml" ]; then
    echo "Running WW3 point post-processor..."
    cd {{staging_dir}}
    $WW3_DIR/bin/ww3_ounp || exit 1
fi

echo "WW3 run completed successfully!"